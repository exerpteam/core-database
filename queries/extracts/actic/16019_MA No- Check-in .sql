-- The extract is extracted from Exerp on 2026-02-08
--  
SELECT DISTINCT p.center || 'p' || p.id as PersonID, c.name, P.FULLNAME, DECODE (P.STATUS, 0,'Lead', 1,'Active', 2,'Inactive', 3,'Temporary inactive', 4,'Transferred', 5,'Duplicate', 6,'Prospect', 7,'Deleted', 8, 'Anonimized', 9, 'Contact', 'Unknown') AS STATUS, DECODE ( P.PERSONTYPE, 0,'Private', 1,'Student', 2,'Staff', 3,'Friend', 4,'Corporate', 5,'One man corporate', 6,'Family', 7,'Senior', 8,'Guest','Unknown') AS PERSONTYPE, ph.txtvalue AS phonehome, pm.txtvalue AS phonemobile FROM PERSONS P LEFT JOIN SUBSCRIPTIONS S ON  P.CENTER = S.OWNER_CENTER  AND P.ID = S.OWNER_ID left join centers c on p.center = c.id left join entityidentifiers E1 on p.center = E1.ref_center and p.id = E1.ref_id and E1.idmethod = 1 and E1.entitystatus = 1 left join entityidentifiers E2 on p.center = E2.ref_center and p.id = E2.ref_id and E2.idmethod = 2 and E2.entitystatus = 1 left join entityidentifiers E4 on p.center = E4.ref_center and p.id = E4.ref_id and E4.idmethod = 4 and E4.entitystatus = 1 left join entityidentifiers E5 on p.center = E5.ref_center and p.id = E5.ref_id and E5.idmethod = 5 and E5.entitystatus = 1 left join relatives r on p.center = r.relativecenter and p.id = r.relativeid and r.rtype = 2 and r.status <> 3 left join person_ext_attrs ph on ph.personcenter = p.center and ph.personid = p.id and ph.name = '_eClub_PhoneHome' left join person_ext_attrs pem on pem.personcenter = p.center and pem.personid = p.id and pem.name = '_eClub_Email' left join person_ext_attrs pm on pm.personcenter = p.center and pm.personid = p.id and pm.name = '_eClub_PhoneSMS' WHERE P.CENTER IN ($$scope$$) AND NOT EXISTS  ( SELECT * FROM CHECKIN_LOG WHERE CHECKIN_LOG.CENTER = P.CENTER AND CHECKIN_LOG.ID = P.ID and CHECKIN_TIME BETWEEN :No_Check_in_from_date AND :No_Check_in_To_date )
 AND P.STATUS IN ( :PersonStatus )

