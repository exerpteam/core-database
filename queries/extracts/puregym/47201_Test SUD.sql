SELECT
        t1.ID as mprID,
        t1.freezePrice,
        t1.FreezePriceStart,
        t1.GLOBALID,
        t1.CACHED_PRODUCTNAME,
        t1.STATE,
        t1.ProductType,
        (CASE t1.SCOPE_TYPE
                        WHEN 'A' THEN 'AREA'
                        WHEN 'C' THEN 'CENTER'
                        ELSE 'FIX'
        END) AS SCOPE_TYPE,
        (CASE t1.SCOPE_TYPE
                        WHEN 'A' THEN a.NAME
                        WHEN 'C' THEN c.NAME
                        ELSE 'FIX'
        END) AS SCOPE_NAME,
        t1.SCOPE_ID,
        NULL AS NEW_FREEZE_PRICE
        
FROM
(
        SELECT
                mpr.ID,
                xt.freezePrice,
                xt2.priceStart AS FreezePriceStart,
                mpr.GLOBALID,
                mpr.CACHED_PRODUCTNAME,
                mpr.STATE,
                (CASE mpr.CACHED_PRODUCTTYPE
                        WHEN 10 THEN 'SUBSCRIPTION'
                        ELSE 'CONTACT EXERP'
                END) AS ProductType,
                mpr.SCOPE_TYPE,
                mpr.SCOPE_ID
        FROM 
                PUREGYM.MASTERPRODUCTREGISTER mpr
                ,XMLTABLE('/subscriptionType/freeze/period/product/prices/price' PASSING XMLType(mpr.PRODUCT,871) COLUMNS freezePrice VARCHAR2(100) PATH 'normalPrice') xt
                ,XMLTABLE('/subscriptionType/freeze/period/product/prices/price' PASSING XMLType(mpr.PRODUCT,871) COLUMNS priceStart DATE PATH '@start') xt2
        WHERE
                mpr.GLOBALID IN  ('COVENTRY_CLUSTER','DD_STANDARD','DD_TIER_010','DD_TIER_020','DD_TIER_030','DD_TIER_040','DD_TIER_050','DD_TIER_060','DD_TIER_070','DD_TIER_080','DD_TIER_090','DD_TIER_100','DD_TIER_1000','DD_TIER_101','DD_TIER_102','DD_TIER_103','DD_TIER_104','DD_TIER_110','DD_TIER_120','DD_TIER_130','DD_TIER_140','DD_TIER_141','DD_TIER_142','DD_TIER_150','DD_TIER_160','DD_TIER_161','DD_TIER_170','DD_TIER_180','DD_TIER_181','DD_TIER_190','DD_TIER_200','DD_TIER_210','DD_TIER_220','DD_TIER_230','DD_TIER_240','DD_TIER_250','DD_TIER_260','DD_TIER_270','DD_TIER_271','DD_TIER_280','DD_TIER_777','EDINBURGH_CLUSTER','EXTRA_MULTI_5699','EXTRA_MULTI_ACCESS:_4699','EXTRA_MULTI_ACCESS:_4899','EXTRA_MULTI_ACCESS:_499','EXTRA_MULTI_ACCESS:_4999','EXTRA_MULTI_ACCESS:_£13.99','EXTRA_MULTI_ACCESS:_£17.99','EXTRA_MULTI_ACCESS:_£18.99','EXTRA_MULTI_ACCESS:_£19.99','EXTRA_MULTI_ACCESS:_£20.99','EXTRA_MULTI_ACCESS:_£21.99','EXTRA_MULTI_ACCESS:_£22.99','EXTRA_MULTI_ACCESS:_£23.99','EXTRA_MULTI_ACCESS:_£24.99','EXTRA_MULTI_ACCESS:_£25.99','EXTRA_MULTI_ACCESS:_£26.99','EXTRA_MULTI_ACCESS:_£27.99','EXTRA_MULTI_ACCESS:_£28.99','EXTRA_MULTI_ACCESS:_£29.99','EXTRA_MULTI_ACCESS:_£30.99','EXTRA_MULTI_ACCESS:_£31.99','EXTRA_MULTI_ACCESS:_£32.99','EXTRA_MULTI_ACCESS:_£33.99','EXTRA_MULTI_ACCESS:_£34.99','EXTRA_MULTI_ACCESS:_£35.99','EXTRA_MULTI_ACCESS:_£36.99','EXTRA_MULTI_ACCESS:_£37.99','EXTRA_MULTI_ACCESS:_£38.99','EXTRA_MULTI_ACCESS:_£39.99','EXTRA_MULTI_ACCESS:_£40.99','EXTRA_MULTI_ACCESS:_£41.99','EXTRA_MULTI_ACCESS:_£42.99','EXTRA_MULTI_ACCESS:_£43.99','EXTRA_MULTI_ACCESS:_£44.99','EXTRA_MULTI_ACCESS:_£45.99','EXTRA_MULTI_ACCESS_4699','EXTRA_MULTI_SOUTH_KEN_104','FREE_JOINING_LOCAL_ACCESS','GLASGOW_CLUSTER','GREENWICH_CLUSTER','IRISH_CLUSTER','LAX_KENSINGTON_MONTHLY','LA_FITNESS_EXMEMBER','LA_FITNESS_TEMP_MEMBERSHIP','LEICESTER_CLUSTER','MULTI_ACCESS:_£12.99','MULTI_ACCESS_100','MULTI_ACCESS_101','MULTI_ACCESS_1299','MULTI_ACCESS_1399','MULTI_ACCESS_1499','MULTI_ACCESS_1599','MULTI_ACCESS_1699','MULTI_ACCESS_1799','MULTI_ACCESS_1899','MULTI_ACCESS_1999','MULTI_ACCESS_2099','MULTI_ACCESS_2199','MULTI_ACCESS_2299','MULTI_ACCESS_2399','MULTI_ACCESS_2499','MULTI_ACCESS_2599','MULTI_ACCESS_2699','MULTI_ACCESS_2799','MULTI_ACCESS_2899','MULTI_ACCESS_2999','MULTI_ACCESS_3099','MULTI_ACCESS_3199','MULTI_ACCESS_3299','MULTI_ACCESS_3399','MULTI_ACCESS_3499','MULTI_ACCESS_3599','MULTI_ACCESS_3699','MULTI_ACCESS_3799','MULTI_ACCESS_3899','MULTI_ACCESS_3999','MULTI_ACCESS_4099','MULTI_ACCESS_4099_2','MULTI_ACCESS_4199','MULTI_ACCESS_42_40_4399','MULTI_ACCESS_43_41','MULTI_ACCESS_44_42','MULTI_ACCESS_45_42','MULTI_ACCESS_5299','MULTI_ACCESS_70','MULTI_ACCESS_71','OFFPEAK','OFFPEAK_2','OFF_PEAK_MEMBERSHIP_PHASE_4','OFF_PEAK_MEMBERSHIP_PHASE_5','OFF_PEAK_PHASE_3','OFF_PEAK_PHASE_6','OFF_PEAK_U18','PREJOIN_JF','PREJOIN_JF_PG','PREJOIN_LOCAL_ACCESS','READING_CLUSTER','SINGLE_ACCESS_SOHO','SINGLE_ACCESS_SUBSCRIPTION','SOUTHAMPTON_CLUSTER','WELSH_CLUESTER','AXA_CORE_30','AXA_CORE_40','AXA_CORE_50','AXA_EXISTING_MEMBER_ACCESS_100','AXA_EXISTING_MEMBER_ACCESS_200','AXA_EXISTING_MEMBER_ACCESS_300','AXA_MULTI_30','AXA_MULTI_40','AXA_MULTI_50','AXA_MULTI_ACCESS_100','AXA_MULTI_ACCESS_200','AXA_MULTI_ACCESS_300','AXA_TUNBRIDGE','COMP_ADDITIONAL_CORP','CORP_COMP_NATIONAL','CORP_NATIONAL_MOVEGB_IN_LONDON','CORP_NATIONAL_MOVEGB_OUT_LONDO','CORPORATE_AXA','CORPORATE_EXTRA_1799','CORPORATE_EXTRA_1899','CORPORATE_EXTRA_1999','CORPORATE_EXTRA_2099','CORPORATE_EXTRA_2199','CORPORATE_EXTRA_2299','CORPORATE_EXTRA_2399','CORPORATE_EXTRA_2499','CORPORATE_EXTRA_2599','CORPORATE_EXTRA_2699','CORPORATE_EXTRA_2799','CORPORATE_EXTRA_2899','CORPORATE_EXTRA_2999','CORPORATE_EXTRA_3099','CORPORATE_EXTRA_3199','CORPORATE_EXTRA_3299','CORPORATE_EXTRA_3399','CORPORATE_EXTRA_3499','CORPORATE_EXTRA_3599','CORPORATE_EXTRA_3699','CORPORATE_EXTRA_3799','CORPORATE_EXTRA_3899','CORPORATE_EXTRA_3999','CORPORATE_EXTRA_4099','CORPORATE_EXTRA_4199','CORPORATE_EXTRA_4299','CORPORATE_EXTRA_4399','CORPORATE_EXTRA_4499','CORPORATE_EXTRA_4599','CORPORATE_EXTRA_4699','CORPORATE_EXTRA_4999','CORPORATE_EXTRA_5199','CORPORATE_EXTRA_5499','CORPORATE_EXTRA_5599','CORPORATE_EXTRA_5999','CORPORATE_MONTHLY','CORPORATE_PIF_NORDEA_EXTENTION','EXTRA_MULTI_5499','EXTRA_MULTI_ACCESS:_5199','FAMILY_FRIEND_COMPLIMENTARY','LA_PIF_SPONSOR','LA_TEMP_10','LA_TEMP_15','LAX_PIF','LOCAL_ACCESS_16_RESTRICTED','LOCAL_ACCESS_16_UNRESTRICTED','MULTI_ACCESS_4799','OFF_PEAK_MEMBERSHIP_PHASE_7','PLUS_MULTI_ACCESS:_5699','PLUS_MULTI_ACCESS:_5999','REWARDS_GATEWAY_12_MONTH_PIF','TIER_270') 
) t1
LEFT JOIN
        PUREGYM.AREAS a ON t1.SCOPE_TYPE = 'A' AND a.ID = t1.SCOPE_ID
LEFT JOIN
        PUREGYM.CENTERS c ON t1.SCOPE_TYPE = 'C' AND c.ID = t1.SCOPE_ID