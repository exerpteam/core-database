SELECT S.CENTER, S.ID, DECODE (STATE, 2,'Active', 3,'Ended', 4,'Frozen', 7,'Window', 8,'Created','Unknown') as STATE, DECODE (SUB_STATE, 1,'None', 6, 'Transferred', 9,'Blocked') AS SUB_STATE, S.SUBSCRIPTIONTYPE_CENTER, S.BINDING_END_DATE, S.SUBSCRIPTION_PRICE, S.START_DATE, S.END_DATE, S.TRANSFERRED_CENTER, PR.NAME FROM SUBSCRIPTIONS S AND P.ID = S.OWNER_ID LEFT JOIN PRODUCTS PR ON PR.CENTER = S.SUBSCRIPTIONTYPE_CENTER AND PR.ID = S.SUBSCRIPTIONTYPE_ID WHERE P.CENTER IN (205,204,207,206,201,203,202,220,221,222,223,216,217,218,219,212,213,214,215,208,209,210,211,102,103,100,101,108,106,107,225,104,224,105) AS P.FIRSTNAME, P.LASTNAME, P.SEX, P.ADDRESS1, P.ZIPCODE, P.BIRTHDATE, P.CITY, ph.txtvalue AS phonehome, pm.txtvalue AS phonemobile, pem.txtvalue AS email,P.FIRST_ACTIVE_START_DATE FROM PERSONS P AND S.END_DATE >= :End_Date_From AND S.END_DATE <= :End_Date_To
 AND P.STATUS IN ( :PersonStatus ) AND S.STATE IN ( :Subscription_state )
