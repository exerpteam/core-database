-- The extract is extracted from Exerp on 2026-02-08
--  
SELECT (a.id)::character varying(255) AS "ACTIVITY_ID", a.name AS "NAME", a.state AS "STATE", bi_decode_field('ACTIVITY'::character varying, 'ACTIVITY_TYPE'::character varying, a.activity_type) AS activity_type, (a.activity_group_id)::character varying(255) AS "ACTIVITY_GROUP_ID", cg.name AS "COLOR", CASE WHEN (COALESCE(a.max_participants, 0) <= 0) THEN 0 ELSE a.max_participants END AS "MAX_PARTICIPANTS", CASE WHEN (COALESCE(a.max_waiting_list_participants, 0) <= 0) THEN 0 ELSE a.max_waiting_list_participants END AS "MAX_WAITING_LIST_PARTICIPANTS", a.external_id AS "ACTIVITY_EXTERNAL_ID", (pc.access_group_id)::character varying(255) AS "ACCESS_GROUP_ID", a.description AS "DESCRIPTION", a.time_config_id AS "TIME_CONFIGURATION_ID", CASE WHEN (a.course_schedule_type = 0) THEN 'FIXED'::text WHEN (a.course_schedule_type = 1) THEN 'CONTINUOUS'::text ELSE ''::text END AS "COURSE_SCHEDULE_TYPE", CASE WHEN (a.age_group_id = '-1'::integer) THEN NULL::character varying ELSE (a.age_group_id)::character varying(255) END AS "AGE_GROUP_ID", ( CASE WHEN (a.energy_consumption_kcal_hour = '-1'::integer) THEN NULL::integer ELSE a.energy_consumption_kcal_hour END)::character varying(255) AS "ENERGY_CONSUMPTION", a.last_modified AS "ETS" FROM (((activity a LEFT JOIN colour_groups cg ON (((a.colour_group_id = cg.id) AND (a.colour_group_id IS NOT NULL)))) LEFT JOIN activity_group ag ON (((a.activity_group_id = ag.id) AND (a.activity_group_id IS NOT NULL)))) LEFT JOIN participation_configurations pc ON (((a.id = pc.activity_id) AND (pc.access_group_id IS NOT NULL)))) WHERE (((a.state)::text <> 'DRAFT'::text) AND (a.top_node_id IS NULL)) 
